{"ast":null,"code":"import jwt_decode from 'jwt-decode';\nexport const getToken = () => {\n  return localStorage.getItem('token');\n};\nexport const setToken = token => {\n  localStorage.setItem('token', token);\n};\nexport const removeToken = () => {\n  localStorage.removeItem('token');\n};\nexport const isTokenValid = () => {\n  const token = getToken();\n  if (!token) return false;\n  try {\n    const decoded = jwt_decode(token);\n    return decoded.exp * 1000 > Date.now();\n  } catch {\n    return false;\n  }\n};\nexport const getAuthHeader = () => {\n  const token = getToken();\n  return token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n};","map":{"version":3,"names":["jwt_decode","getToken","localStorage","getItem","setToken","token","setItem","removeToken","removeItem","isTokenValid","decoded","exp","Date","now","getAuthHeader","Authorization"],"sources":["C:/Users/admin/cybersecurity-platform/frontend/src/utils/auth.js"],"sourcesContent":["import jwt_decode from 'jwt-decode';\r\n\r\nexport const getToken = () => {\r\n  return localStorage.getItem('token');\r\n};\r\n\r\nexport const setToken = (token) => {\r\n  localStorage.setItem('token', token);\r\n};\r\n\r\nexport const removeToken = () => {\r\n  localStorage.removeItem('token');\r\n};\r\n\r\nexport const isTokenValid = () => {\r\n  const token = getToken();\r\n  if (!token) return false;\r\n\r\n  try {\r\n    const decoded = jwt_decode(token);\r\n    return decoded.exp * 1000 > Date.now();\r\n  } catch {\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const getAuthHeader = () => {\r\n  const token = getToken();\r\n  return token ? { Authorization: `Bearer ${token}` } : {};\r\n}; "],"mappings":"AAAA,OAAOA,UAAU,MAAM,YAAY;AAEnC,OAAO,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAC5B,OAAOC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AACtC,CAAC;AAED,OAAO,MAAMC,QAAQ,GAAIC,KAAK,IAAK;EACjCH,YAAY,CAACI,OAAO,CAAC,OAAO,EAAED,KAAK,CAAC;AACtC,CAAC;AAED,OAAO,MAAME,WAAW,GAAGA,CAAA,KAAM;EAC/BL,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC;AAClC,CAAC;AAED,OAAO,MAAMC,YAAY,GAAGA,CAAA,KAAM;EAChC,MAAMJ,KAAK,GAAGJ,QAAQ,CAAC,CAAC;EACxB,IAAI,CAACI,KAAK,EAAE,OAAO,KAAK;EAExB,IAAI;IACF,MAAMK,OAAO,GAAGV,UAAU,CAACK,KAAK,CAAC;IACjC,OAAOK,OAAO,CAACC,GAAG,GAAG,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;EACxC,CAAC,CAAC,MAAM;IACN,OAAO,KAAK;EACd;AACF,CAAC;AAED,OAAO,MAAMC,aAAa,GAAGA,CAAA,KAAM;EACjC,MAAMT,KAAK,GAAGJ,QAAQ,CAAC,CAAC;EACxB,OAAOI,KAAK,GAAG;IAAEU,aAAa,EAAE,UAAUV,KAAK;EAAG,CAAC,GAAG,CAAC,CAAC;AAC1D,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}