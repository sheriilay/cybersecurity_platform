{"ast":null,"code":"import axios from 'axios';\nimport API_CONFIG, { API_ENDPOINTS } from '../config';\nconst authService = {\n  async login(username, password) {\n    try {\n      const response = await axios.post(`${API_ENDPOINTS}${API_ENDPOINTS}`, {\n        username,\n        password\n      });\n      const {\n        accessToken,\n        refreshToken,\n        user\n      } = response.data;\n      this.setTokens(accessToken, refreshToken);\n      return user;\n    } catch (error) {\n      throw this.handleError(error);\n    }\n  },\n  async register(username, password, email) {\n    try {\n      const response = await axios.post(`${API_ENDPOINTS}${API_ENDPOINTS}`, {\n        username,\n        password,\n        email\n      });\n      const {\n        accessToken,\n        refreshToken,\n        user\n      } = response.data;\n      this.setTokens(accessToken, refreshToken);\n      return user;\n    } catch (error) {\n      throw this.handleError(error);\n    }\n  },\n  async refreshToken() {\n    try {\n      const refreshToken = localStorage.getItem(API_ENDPOINTS);\n      if (!refreshToken) {\n        throw new Error('No refresh token available');\n      }\n      const response = await axios.post(`${API_ENDPOINTS}${API_ENDPOINTS}`, {\n        refreshToken\n      });\n      const {\n        accessToken,\n        refreshToken: newRefreshToken\n      } = response.data;\n      this.setTokens(accessToken, newRefreshToken);\n      return accessToken;\n    } catch (error) {\n      this.clearTokens();\n      throw this.handleError(error);\n    }\n  },\n  async verifyToken() {\n    try {\n      const token = this.getAccessToken();\n      if (!token) {\n        throw new Error('No token available');\n      }\n      const response = await axios.get(`${API_ENDPOINTS}${API_ENDPOINTS}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      return response.data.user;\n    } catch (error) {\n      var _error$response;\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n        try {\n          await this.refreshToken();\n          return this.verifyToken();\n        } catch (refreshError) {\n          this.clearTokens();\n          throw this.handleError(refreshError);\n        }\n      }\n      throw this.handleError(error);\n    }\n  },\n  logout() {\n    this.clearTokens();\n  },\n  setTokens(accessToken, refreshToken) {\n    if (accessToken) {\n      localStorage.setItem(API_ENDPOINTS, accessToken);\n    }\n    if (refreshToken) {\n      localStorage.setItem(API_ENDPOINTS, refreshToken);\n    }\n  },\n  clearTokens() {\n    localStorage.removeItem(API_ENDPOINTS);\n    localStorage.removeItem(API_ENDPOINTS);\n  },\n  getAccessToken() {\n    return localStorage.getItem(API_ENDPOINTS);\n  },\n  getRefreshToken() {\n    return localStorage.getItem(API_ENDPOINTS);\n  },\n  isAuthenticated() {\n    return !!this.getAccessToken();\n  },\n  handleError(error) {\n    if (error.response) {\n      var _error$response$data, _error$response$data2;\n      // The request was made and the server responded with a status code\n      // that falls out of the range of 2xx\n      const message = ((_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || ((_error$response$data2 = error.response.data) === null || _error$response$data2 === void 0 ? void 0 : _error$response$data2.error) || 'An error occurred';\n      return new Error(message);\n    } else if (error.request) {\n      // The request was made but no response was received\n      return new Error('No response from server. Please check your connection.');\n    } else {\n      // Something happened in setting up the request that triggered an Error\n      return new Error('Request failed. Please try again.');\n    }\n  }\n};\n\n// Add axios interceptor for token refresh\naxios.interceptors.response.use(response => response, async error => {\n  var _error$response2;\n  const originalRequest = error.config;\n  if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 401 && !originalRequest._retry) {\n    originalRequest._retry = true;\n    try {\n      const newToken = await authService.refreshToken();\n      originalRequest.headers.Authorization = `Bearer ${newToken}`;\n      return axios(originalRequest);\n    } catch (refreshError) {\n      authService.clearTokens();\n      window.location.href = '/login';\n      return Promise.reject(refreshError);\n    }\n  }\n  return Promise.reject(error);\n});\n\n// Add axios interceptor for adding token to requests\naxios.interceptors.request.use(config => {\n  const token = authService.getAccessToken();\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => Promise.reject(error));\nexport default authService;","map":{"version":3,"names":["axios","API_CONFIG","API_ENDPOINTS","authService","login","username","password","response","post","accessToken","refreshToken","user","data","setTokens","error","handleError","register","email","localStorage","getItem","Error","newRefreshToken","clearTokens","verifyToken","token","getAccessToken","get","headers","Authorization","_error$response","status","refreshError","logout","setItem","removeItem","getRefreshToken","isAuthenticated","_error$response$data","_error$response$data2","message","request","interceptors","use","_error$response2","originalRequest","config","_retry","newToken","window","location","href","Promise","reject"],"sources":["C:/Users/admin/cybersecurity-platform (6)/cybersecurity-platform v1/frontend/src/services/auth.js"],"sourcesContent":["import axios from 'axios';\nimport API_CONFIG, { API_ENDPOINTS } from '../config';\n\nconst authService = {\n  async login(username, password) {\n    try {\n      const response = await axios.post(`${API_ENDPOINTS}${API_ENDPOINTS}`, {\n        username,\n        password\n      });\n\n      const { accessToken, refreshToken, user } = response.data;\n      this.setTokens(accessToken, refreshToken);\n      return user;\n    } catch (error) {\n      throw this.handleError(error);\n    }\n  },\n\n  async register(username, password, email) {\n    try {\n      const response = await axios.post(`${API_ENDPOINTS}${API_ENDPOINTS}`, {\n        username,\n        password,\n        email\n      });\n\n      const { accessToken, refreshToken, user } = response.data;\n      this.setTokens(accessToken, refreshToken);\n      return user;\n    } catch (error) {\n      throw this.handleError(error);\n    }\n  },\n\n  async refreshToken() {\n    try {\n      const refreshToken = localStorage.getItem(API_ENDPOINTS);\n      if (!refreshToken) {\n        throw new Error('No refresh token available');\n      }\n\n      const response = await axios.post(`${API_ENDPOINTS}${API_ENDPOINTS}`, {\n        refreshToken\n      });\n\n      const { accessToken, refreshToken: newRefreshToken } = response.data;\n      this.setTokens(accessToken, newRefreshToken);\n      return accessToken;\n    } catch (error) {\n      this.clearTokens();\n      throw this.handleError(error);\n    }\n  },\n\n  async verifyToken() {\n    try {\n      const token = this.getAccessToken();\n      if (!token) {\n        throw new Error('No token available');\n      }\n\n      const response = await axios.get(`${API_ENDPOINTS}${API_ENDPOINTS}`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n\n      return response.data.user;\n    } catch (error) {\n      if (error.response?.status === 401) {\n        try {\n          await this.refreshToken();\n          return this.verifyToken();\n        } catch (refreshError) {\n          this.clearTokens();\n          throw this.handleError(refreshError);\n        }\n      }\n      throw this.handleError(error);\n    }\n  },\n\n  logout() {\n    this.clearTokens();\n  },\n\n  setTokens(accessToken, refreshToken) {\n    if (accessToken) {\n      localStorage.setItem(API_ENDPOINTS, accessToken);\n    }\n    if (refreshToken) {\n      localStorage.setItem(API_ENDPOINTS, refreshToken);\n    }\n  },\n\n  clearTokens() {\n    localStorage.removeItem(API_ENDPOINTS);\n    localStorage.removeItem(API_ENDPOINTS);\n  },\n\n  getAccessToken() {\n    return localStorage.getItem(API_ENDPOINTS);\n  },\n\n  getRefreshToken() {\n    return localStorage.getItem(API_ENDPOINTS);\n  },\n\n  isAuthenticated() {\n    return !!this.getAccessToken();\n  },\n\n  handleError(error) {\n    if (error.response) {\n      // The request was made and the server responded with a status code\n      // that falls out of the range of 2xx\n      const message = error.response.data?.message || error.response.data?.error || 'An error occurred';\n      return new Error(message);\n    } else if (error.request) {\n      // The request was made but no response was received\n      return new Error('No response from server. Please check your connection.');\n    } else {\n      // Something happened in setting up the request that triggered an Error\n      return new Error('Request failed. Please try again.');\n    }\n  }\n};\n\n// Add axios interceptor for token refresh\naxios.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config;\n\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      try {\n        const newToken = await authService.refreshToken();\n        originalRequest.headers.Authorization = `Bearer ${newToken}`;\n        return axios(originalRequest);\n      } catch (refreshError) {\n        authService.clearTokens();\n        window.location.href = '/login';\n        return Promise.reject(refreshError);\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\n// Add axios interceptor for adding token to requests\naxios.interceptors.request.use(\n  (config) => {\n    const token = authService.getAccessToken();\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\nexport default authService; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}